package net.mind_engine.oculus.testrunframework.reporter.nodes;

import net.mind_engine.oculus.testrunframework.reporter.ReportDesign;

public class ExceptionReportNode extends ReportNode
{
    /**
     * 
     */
    private static final long serialVersionUID = -7964782842091110158L;
    private transient Throwable throwable;

    public void setThrowable(Throwable throwable)
    {
        this.throwable = throwable;
        
        setText(throwable.getMessage());
        setName(throwable.getClass().getName());
        //Adding stack trace to the details
        StringBuffer str = new StringBuffer();
        StackTraceElement[]stack = throwable.getStackTrace();
        for(int i=0;i<stack.length;i++)
        {
            str.append(stack[i]);
            str.append(ReportDesign.breakline());
        }
        DescriptionReportNode detailsNode = new DescriptionReportNode();
        detailsNode.setText(ReportDesign.stackTrace(str.toString()));
        getChildren().add(detailsNode);
    }

    public Throwable getThrowable()
    {
        return throwable;
    }
    
    @Override
    public String getReason()
    {
        if(throwable!=null)
        {
            return throwable.getClass().getName()+": "+throwable.getMessage();
        }
        return super.getReason();
    }
}
